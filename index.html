<!doctype html>
<html lang="zh-CN" data-route="home">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/icon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NovelBox</title>
    <style>
      /* 为片段编辑器页面设置透明背景 */
      html[data-route="fragment-editor"],
      html[data-route="fragment-editor"] body {
        background-color: transparent !important;
      }
      
      /* macOS全局UI修复 - 直接注入确保加载 */
      @media screen and (-webkit-min-device-pixel-ratio: 2),
             screen and (min-resolution: 192dpi) {
        
        /* 基础布局修复 */
        body {
          font-family: "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Segoe UI", Arial, sans-serif !important;
          -webkit-font-smoothing: subpixel-antialiased !important;
          -moz-osx-font-smoothing: auto !important;
          margin: 0 !important;
          padding: 0 !important;
        }
        
        /* 强制修复flexbox布局 */
        .novel-editor-page {
          display: flex !important;
          flex-direction: column !important;
          height: 100vh !important;
          width: 100vw !important;
          overflow: hidden !important;
        }
        
        .editor-header {
          flex-shrink: 0 !important;
          padding-top: env(safe-area-inset-top, 28px) !important;
        }
        
        .editor-main {
          display: flex !important;
          flex-direction: row !important;
          flex: 1 1 auto !important;
          min-height: 0 !important;
          overflow: hidden !important;
        }
        
        .editor-sidebar {
          flex-shrink: 0 !important;
          width: 240px !important;
          overflow-y: auto !important;
          overflow-x: hidden !important;
        }
        
        .editor-content {
          flex: 1 1 auto !important;
          min-width: 0 !important;
          overflow: auto !important;
        }
        
        /* 标题栏布局修复 */
        .title-section {
          display: flex !important;
          align-items: center !important;
          justify-content: space-between !important;
          width: 100% !important;
          position: relative !important;
        }
        
        .left-section, .right-section {
          flex-shrink: 0 !important;
          position: static !important;
        }
        
        .center-section {
          flex: 1 1 auto !important;
          display: flex !important;
          justify-content: center !important;
          min-width: 0 !important;
        }
        
        /* 书库页面修复 */
        .book-library-page {
          display: flex !important;
          flex-direction: column !important;
          min-height: 100vh !important;
        }
        
        .library-header {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          flex-shrink: 0 !important;
        }
        
        .page-title {
          flex: 1 1 auto !important;
          text-align: center !important;
          margin: 0 !important;
        }
        
        /* 模态框层级修复 */
        .modal-overlay {
          position: fixed !important;
          top: 0 !important;
          left: 0 !important;
          right: 0 !important;
          bottom: 0 !important;
          z-index: 99999 !important;
          background: rgba(0, 0, 0, 0.5) !important;
        }
        
        .modal {
          position: fixed !important;
          top: 50% !important;
          left: 50% !important;
          transform: translate(-50%, -50%) !important;
          z-index: 100000 !important;
          margin: 0 !important;
          max-height: 90vh !important;
          max-width: 90vw !important;
        }
        
        /* Element Plus组件修复 */
        .el-dialog__wrapper {
          position: fixed !important;
          top: 0 !important;
          left: 0 !important;
          right: 0 !important;
          bottom: 0 !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          z-index: 99999 !important;
        }
        
        .el-dialog {
          margin: 0 !important;
          position: relative !important;
          max-height: 90vh !important;
          max-width: 90vw !important;
        }
        
        .el-select-dropdown, .el-dropdown-menu {
          position: fixed !important;
          z-index: 100001 !important;
        }
        
        /* 强制修复所有flex容器 */
        [class*="flex"]:not(button):not([class*="btn"]):not([class*="button"]) {
          display: flex !important;
        }
        
        [class*="flex-col"]:not(button):not([class*="btn"]):not([class*="button"]) {
          flex-direction: column !important;
        }
        
        [class*="flex-row"]:not(button):not([class*="btn"]):not([class*="button"]) {
          flex-direction: row !important;
        }
        
        [class*="items-center"]:not(button):not([class*="btn"]):not([class*="button"]) {
          align-items: center !important;
        }
        
        [class*="justify-between"]:not(button):not([class*="btn"]):not([class*="button"]) {
          justify-content: space-between !important;
        }
        
        /* 修复按钮和输入框 */
        button, .el-button {
          -webkit-appearance: none !important;
          -moz-appearance: none !important;
          appearance: none !important;
        }
        
        /* 防止内容溢出 */
        .book-title, .page-title {
          max-width: 100% !important;
          overflow: hidden !important;
          text-overflow: ellipsis !important;
          white-space: nowrap !important;
        }
        
        /* 修复网格布局 */
        .books-container {
          display: grid !important;
          grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)) !important;
          gap: 1.5rem !important;
        }
        
        /* 强制隐藏溢出的内容 */
        * {
          box-sizing: border-box !important;
        }
        
        /* 修复定位上下文 */
        .app-container {
          position: relative !important;
          isolation: isolate !important;
        }
        
        /* 修复滚动行为 */
        .overflow-auto, .overflow-y-auto {
          overflow: auto !important;
          -webkit-overflow-scrolling: touch !important;
        }
        
        .overflow-hidden {
          overflow: hidden !important;
        }
      }
    </style>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
